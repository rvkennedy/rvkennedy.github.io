---
title: 5.2 Shaders
layout: reference
url: 5.2 Shaders
---
<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>trueSKY: 5.2 Shaders</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">5.2 Shaders </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>trueSKY uses <em>effects</em> for rendering. An effect is a collection of shaders - vertex shaders, pixel shaders and so on, along with information on how to combine them, how to set render state when they are used, and what inputs they take.</p>
<p>Platform-specific derived classes of <a class="el" href="classsimul_1_1crossplatform_1_1Effect.html">Effect</a> are created with <a class="el" href="classsimul_1_1crossplatform_1_1RenderPlatform.html#ab932243b462874e6cb2d4581b0000f09">RenderPlatform::CreateEffect</a>, usually with an extensionless filename passed to the function.</p>
<p>The RenderPlatform first looks for a platform-specific shader source file by appending its platform shader file extension - .fx effect files for DirectX, .glfx files for GLSL etc. If this is not found, the cross-platform .sfx extension is appended.</p>
<p>The #include directive has been enabled - DirectX handles this by design; while Simul has implemented #include for GLSL. Platform-specific include files have the suffix .hlsl, .glsl, etc., while cross-platform includes have extension .sl.</p>
<p>As far as possible, the functional aspects of shading are defined in cross-platform shader include files, which have been given the .sl suffix, and can be found in the Simul/Platform/CrossPlatform/SL directory.</p>
<p>In order for the different shader languages to use these common files, each platform has a special file that is included before any .sl files, and which contains definitions needed for the .sl files, including macros and functions - see CppHlsl.hlsl, etc.</p>
<h2>Constant Buffers </h2>
<p>Older versions of GLSL, and DirectX 9, pass constants to shaders individually. </p><pre class="fragment">(in HLSL)
float brightness;

(in C++)
D3DXHANDLE h=effect-&gt;GetParameterByName(NULL,"brightness");
effect-&gt;SetFloat(h,1.0);
</pre><p>OpenGL 3.0 and DirectX 11 have the capability to use <em>constant</em> <em>buffers</em> instead, so if we define in the shader: </p><pre class="fragment">(in GLSL)
layout(std140) uniform ShaderConstants
{
    uniform float brightness;
    uniform float gamma;
    uniform float bloom;
};
</pre><p>etc., and in C++: </p><pre class="fragment">struct ShaderConstants
{
    float brightness;
    uniform float gamma;
    uniform float bloom;
};
</pre><p>it is then possible to set the values of the whole structure in C++, and pass it complete to the shader. For cross-platform constant buffers, we define: </p><pre class="fragment">SIMUL_CONSTANT_BUFFER

SIMUL_CONSTANT_BUFFER_END
</pre><p>and these macros have different expansions depending on whether the header is being used in C++, or in a shader compilation.</p>
<hr/>
<p> Next: <a class="el" href="man_5_classes_ooo3_mixed.html">5.3 Mixed Resolution Compositing</a> </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/>
<address style="text-align: right;">trueSKY VERSION SIMUL_MAJOR_VERSION=4.0.0<small>
Mon Jan 2 2017 07:54:26</small></address>
</body>
</html>
