---
title: Simul/Clouds/CellularCloudNode.h Source File
layout: reference
url: Simul/Clouds/CellularCloudNode.h Source File
---
<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>trueSKY: Simul/Clouds/CellularCloudNode.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_beaf6350625f40cba10f37349f035602.html">Simul</a></li><li class="navelem"><a class="el" href="dir_70c9c40680dd21af3132864279f1cd73.html">Clouds</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CellularCloudNode.h</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef SIMUL_GRAPH_CLOUDS_CELLULARCLOUDNODE_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define SIMUL_GRAPH_CLOUDS_CELLULARCLOUDNODE_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;Simul/Base/Referenced.h&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;Simul/Clouds/CellularCloudGrid.h&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;Simul/Base/MemoryInterface.h&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;Simul/Math/Vector3.h&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    </div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">    #pragma warning(push)</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;    <span class="comment">// C4251 can be ignored in Visual C++ if you are deriving from a type in the Standard C++ Library</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">    #pragma warning(disable:4251)</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">    #pragma warning(disable:4541)</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesimul.html">simul</a></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="keyword">namespace </span>math</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    {</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;        <span class="keyword">class </span>Vector3;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    }</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;}</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesimul.html">simul</a></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <span class="keyword">namespace </span>clouds</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    {</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="classsimul_1_1clouds_1_1HumidityCallbackInterface.html">   34</a></span>&#160;        <span class="keyword">class </span><a class="code" href="classsimul_1_1clouds_1_1HumidityCallbackInterface.html">HumidityCallbackInterface</a></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> <a class="code" href="classsimul_1_1clouds_1_1HumidityCallbackInterface.html#ae9e907b6e189a32348518ea2fe04ab18">GetHumidityMultiplier</a>(<span class="keywordtype">float</span> x,<span class="keywordtype">float</span> y,<span class="keywordtype">float</span> z) <span class="keyword">const</span>=0;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        };</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keyword">class </span><a class="code" href="classsimul_1_1clouds_1_1TimedNoise3D.html">TimedNoise3D</a>;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <span class="keyword">class </span>DoLightSteps;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    }</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacesimul.html">simul</a></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">namespace </span>clouds</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classsimul_1_1clouds_1_1CellularCloudNode.html">   52</a></span>&#160;SIMUL_CLOUDS_EXPORT_CLASS <a class="code" href="classsimul_1_1clouds_1_1CellularCloudNode.html">CellularCloudNode</a>:<span class="keyword">public</span> <a class="code" href="classsimul_1_1clouds_1_1CellularCloudGrid.html">CellularCloudGrid</a>,</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                            <span class="keyword">public</span> <a class="code" href="classsimul_1_1base_1_1Referenced.html">simul::base::Referenced</a></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <a class="code" href="classsimul_1_1clouds_1_1CellularCloudNode.html">CellularCloudNode</a>(<a class="code" href="classsimul_1_1base_1_1MemoryInterface.html">simul::base::MemoryInterface</a> *mem=NULL);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            META_BeginProperties</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            META_PropertyCategory(Generation)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,NoisePersistence           ,0.f    ,1.f    ,Recalculate        ,<span class="stringliteral">&quot;Persistence over successive fractal scales of the cloud-generation noise function.&quot;</span>)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            META_EndPropertyCategory(Generation)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            META_PropertyCategory(Lighting)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,LightResponse              ,0  ,4.f        ,NeedRender         ,<span class="stringliteral">&quot;How brightly the cloud scatters sunlight in all directions&quot;</span>)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,MieAsymmetry               ,0  ,0.9f       ,NeedRender         ,<span class="stringliteral">&quot;Mie scattering eccentricity.&quot;</span>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,AmbientLightResponse       ,0  ,5.f        ,NeedRender         ,<span class="stringliteral">&quot;How brightly the cloud scatters ambient light&quot;</span>)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,SecondaryLightResponse     ,0  ,4.f        ,ChangedSec         ,<span class="stringliteral">&quot;Light contribution from secondary (internal) scattering&quot;</span>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,SelfShadowScale            ,0  ,1.f        ,NeedRelight        ,<span class="stringliteral">&quot;Extent to which self-shadowing fades away.&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,LightExtend                ,0  ,1.f        ,NeedRelight        ,<span class="stringliteral">&quot;When lighting at low angles, how far back to extend the light volume as a proportion of the the cloud volume, default 0.3. Use this to prevent sharp boundary artifacts near sunrise/sunset.&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">int</span>      ,LightDetail                ,1  ,8          ,NeedRelight        ,<span class="stringliteral">&quot;DEPRECATED: How much detail to use in lighting = how much memory it uses.&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,MinimumLightElevationDegrees,-90.f ,90.f   ,NeedRelight        ,<span class="stringliteral">&quot;Minimum elevation for lighting , default 3 degrees - if light direction is below this angle, it will be raised - useful for sunsets. Used to prevent clouds from being lit from below - if the incoming light angle is below this threshold, it is raised. Although clouds can be lit from below in reality, usually this is only possible for very high altitude clouds, due to occlusion from the Earth.&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                META_ValueProperty(<span class="keywordtype">bool</span>                     ,UseCUDA                                                        ,<span class="stringliteral">&quot;Whether to use CUDA (if available, PC only).&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            META_EndPropertyCategory(Lighting)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            META_PropertyCategory(Appearance)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                META_ValueRangePropertyWithSetCall(<span class="keywordtype">float</span>    ,OpticalDensity             ,0  ,12.f       ,NeedRender         ,<span class="stringliteral">&quot;Density of clouds for rendering&quot;</span>)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                META_ValuePropertyWithSetCall(<span class="keywordtype">float</span>         ,Churn                                      ,NeedRender         ,<span class="stringliteral">&quot;Time-dependent churning of cloud fractal edges.&quot;</span>)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                META_ValueProperty(                 <span class="keywordtype">bool</span>    ,ThinLayer                                                      ,<span class="stringliteral">&quot;Draw these clouds as a thin 2D layer?&quot;</span>)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            META_EndPropertyCategory(Appearance)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            META_PropertyCategory(Animation)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                META_ValueRangeProperty(            <span class="keywordtype">float</span>   ,NoisePeriod                ,0      ,0      ,1e23f              ,<span class="stringliteral">&quot;Period (in daytime units, one day = one unit) over which noise changes&quot;</span>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                META_ReferenceProperty(<a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> ,WindOffset                                                     ,<span class="stringliteral">&quot;3D wind offset, in metres.&quot;</span>)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            META_EndPropertyCategory(Animation)</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            META_EndProperties</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keyword">public</span>:</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> *GetTransformToLightspaceMatrix(<span class="keywordtype">unsigned</span> axis,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;dir,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;origin,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;scales) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> *GetTransformLightspaceToCloudspaceMatrix(<span class="keywordtype">unsigned</span> axis,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;dir,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;origin,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;scales,<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            simul::math::NoiseInterface *GetNoiseInterface();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordtype">void</span> SetRecalculate(<span class="keywordtype">bool</span> r)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                changed = r;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <span class="keywordtype">void</span> SetRelight();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classsimul_1_1clouds_1_1CellularCloudNode.html#af744cfb3ad8678af9434018fb489d249">   99</a></span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classsimul_1_1clouds_1_1CellularCloudNode.html#af744cfb3ad8678af9434018fb489d249">NeedsRelight</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="keyword">            </span>{</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="keywordflow">return</span> GetRelightChecksum()!=relit_checksum;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> SaveGrid(std::ostream &amp;os) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> LoadGrid(std::istream &amp;is);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// These are inherited from CloudInterface  </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Generate();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">int</span> GetGenerationNumber() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetOpticalPathLength(<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;dir,<span class="keywordtype">float</span> time,<span class="keywordtype">float</span> cloudiness,<span class="keywordtype">float</span> extinction,<span class="keywordtype">float</span> diffusivity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetOpticalPathLengthBetween(<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X1,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X2,<span class="keywordtype">float</span> time,<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> width,<span class="keywordtype">float</span> height,<span class="keywordtype">float</span> cloudiness,<span class="keywordtype">float</span> extinction,<span class="keywordtype">float</span> diffusivity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetAmbient(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X,<span class="keyword">const</span> <span class="keywordtype">float</span> *ambient_grid);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetLight(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X,<span class="keyword">const</span> <span class="keywordtype">float</span> *light_grid) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetSecondaryLight(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X,<span class="keyword">const</span> <span class="keywordtype">float</span> *light_grid) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> GetExtents(<a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X1,<a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X2,<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <span class="keyword">virtual</span>  <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> GetOrigin(<a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> windOffset,<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> w) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keyword">virtual</span>  <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> GetInverseScales(<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">float</span> GetCloudDensity(<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> width,<span class="keywordtype">float</span> height,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X,<span class="keywordtype">float</span> time,<span class="keywordtype">float</span> cloudiness,<span class="keywordtype">float</span> extinction,<span class="keywordtype">float</span> diffusivity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> GetGrid(<span class="keywordtype">int</span> &amp;w,<span class="keywordtype">int</span> &amp;l,<span class="keywordtype">int</span> &amp;h) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> SetGrid(<span class="keywordtype">int</span> w,<span class="keywordtype">int</span> l,<span class="keywordtype">int</span> h);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> GetGridValues(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">float</span> &amp;density,<span class="keywordtype">float</span> &amp;light,<span class="keywordtype">float</span> &amp;ambient,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                        <span class="keywordtype">float</span> &amp;second,<span class="keywordtype">int</span> x,<span class="keywordtype">int</span> y,<span class="keywordtype">int</span> z,<span class="keyword">const</span> <span class="keywordtype">float</span> *light_grid,<span class="keyword">const</span> <span class="keywordtype">float</span> *ambient_grid,<span class="keywordtype">float</span> time,<span class="keywordtype">float</span> cloudiness,<span class="keywordtype">float</span> extinction,<span class="keywordtype">float</span> diffusivity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            LightingSetupStruct CalcLightingSetup(<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;dir_to_sun,<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> width,<span class="keywordtype">float</span> height) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">bool</span> ReLightPartial(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h,<span class="keywordtype">float</span> proportion,<span class="keywordtype">float</span> *light_grid,<span class="keywordtype">float</span> *ambient_grid,<span class="keywordtype">int</span> &amp;lighting_index,<span class="keywordtype">float</span> time,<span class="keywordtype">float</span> cloudiness,<span class="keywordtype">float</span> extinction);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            std::ostream &amp;StreamOut(std::ostream &amp;os) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            std::istream &amp;StreamIn(std::istream &amp;is);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            std::ostream &amp;StateStreamOut(std::ostream &amp;os) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            std::istream &amp;StateStreamIn(std::istream &amp;is);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="comment">// inherited from MemoryUsageInterface</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">unsigned</span> GetMemoryUsage() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;            <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;ConvertTextureCoordsToReal(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h,<span class="keywordtype">float</span> x,<span class="keywordtype">float</span> y,<span class="keywordtype">float</span> z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;ConvertLightCoordsToReal(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">float</span> x,<span class="keywordtype">float</span> y,<span class="keywordtype">float</span> z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">protected</span>:</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <span class="keywordtype">unsigned</span> GetRelightChecksum() <span class="keyword">const</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordtype">unsigned</span> relit_checksum;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="keywordtype">float</span> lit_humidity;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <span class="keywordtype">float</span> coverage;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            <span class="keywordtype">int</span> GenerationNumber;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="keywordtype">int</span> RelightNumber;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> PrepareToDestroy();</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keyword">virtual</span> ~<a class="code" href="classsimul_1_1clouds_1_1CellularCloudNode.html">CellularCloudNode</a>();</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> ChangedNoise();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            simul::math::RandomNumberGenerator secondary_random;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="keywordtype">void</span> GetGridCoordsAndInterps(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">int</span> &amp;grid_x0,<span class="keywordtype">int</span> &amp;grid_y0,<span class="keywordtype">int</span> &amp;grid_z0,</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                        <span class="keywordtype">float</span> &amp;interp_x,<span class="keywordtype">float</span> &amp;interp_y,<span class="keywordtype">float</span> &amp;interp_z,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X, <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;dir,</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                                        <span class="keywordtype">unsigned</span> axis, <span class="keyword">const</span> <span class="keywordtype">int</span> g[3]) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordtype">float</span> InterpBooleanGridValues(<span class="keywordtype">int</span> grid_x0,<span class="keywordtype">int</span> grid_y0,<span class="keywordtype">int</span> grid_z0,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                            <span class="keywordtype">float</span> interp_x,<span class="keywordtype">float</span> interp_y,<span class="keywordtype">float</span> interp_z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordtype">float</span> InterpGridValues(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keywordtype">int</span> grid_x0,<span class="keywordtype">int</span> grid_y0,<span class="keywordtype">int</span> grid_z0,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                            <span class="keywordtype">float</span> interp_x,<span class="keywordtype">float</span> interp_y,<span class="keywordtype">float</span> interp_z,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">float</span> *lgrid,<span class="keyword">const</span> <span class="keywordtype">int</span> *lgridsize) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <span class="keywordtype">unsigned</span> regen_checksum;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            std::string filename;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="classsimul_1_1clouds_1_1TimedNoise3D.html">TimedNoise3D</a> *timed_noise;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="keywordtype">void</span> CalcLightParameters(   <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;light</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                        ,<span class="keywordtype">int</span> &amp;axis</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                        ,<a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;light_vec</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                        ,<a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;origin</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                        ,<a class="code" href="classsimul_1_1math_1_1Vector3.html">math::Vector3</a> &amp;scales</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                                ,<span class="keywordtype">float</span> &amp;under_light_multiplier,<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> ProjectToEdge(<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X0,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;D, <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;x1,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;x2);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordtype">float</span> InternalCalcOpticalPathLength(<span class="keywordtype">float</span> cloud_base_z,<span class="keywordtype">float</span> w,<span class="keywordtype">float</span> h,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;dir,<span class="keywordtype">float</span> time,<span class="keywordtype">float</span> cloudiness,<span class="keywordtype">float</span> extinction,<span class="keywordtype">float</span> diffusivity) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keywordtype">void</span> GetCoordsFromPosition(<span class="keyword">const</span> LightingSetupStruct &amp;setup,<span class="keyword">const</span> <a class="code" href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a> &amp;X, <span class="keywordtype">unsigned</span> &amp;x,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="keywordtype">unsigned</span> &amp;y, <span class="keywordtype">unsigned</span> &amp;z) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="keywordtype">void</span> NeedRelight();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="keywordtype">void</span> NeedRender();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordtype">void</span> ChangedSec();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="comment">// virtual from grid;</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> Recalculate();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="keyword">virtual</span> <span class="keywordtype">void</span> ChangedGrid();</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="keywordtype">void</span> QuicklightChanged();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordtype">void</span> ChangedCacheNoise();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keyword">friend</span> <span class="keyword">class </span>simul::clouds::DoLightSteps;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordtype">void</span> *access_mutex;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="classsimul_1_1base_1_1MemoryInterface.html">simul::base::MemoryInterface</a> *memoryInterface;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        };</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#ifdef _MSC_VER</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="preprocessor">    #pragma warning(pop)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="classsimul_1_1clouds_1_1CellularCloudGrid_html"><div class="ttname"><a href="classsimul_1_1clouds_1_1CellularCloudGrid.html">simul::clouds::CellularCloudGrid</a></div><div class="ttdef"><b>Definition:</b> <a href="CellularCloudGrid_8h_source.html#l00028">CellularCloudGrid.h:28</a></div></div>
<div class="ttc" id="classsimul_1_1clouds_1_1CellularCloudNode_html"><div class="ttname"><a href="classsimul_1_1clouds_1_1CellularCloudNode.html">simul::clouds::CellularCloudNode</a></div><div class="ttdoc">A cloud class based on cellular automata. </div><div class="ttdef"><b>Definition:</b> <a href="CellularCloudNode_8h_source.html#l00052">CellularCloudNode.h:52</a></div></div>
<div class="ttc" id="classsimul_1_1clouds_1_1TimedNoise3D_html"><div class="ttname"><a href="classsimul_1_1clouds_1_1TimedNoise3D.html">simul::clouds::TimedNoise3D</a></div><div class="ttdoc">A 3D noise generator used for cloud volumes, where the value returned depends on normalized spatial c...</div><div class="ttdef"><b>Definition:</b> <a href="TimedNoise3D_8h_source.html#l00010">TimedNoise3D.h:10</a></div></div>
<div class="ttc" id="classsimul_1_1base_1_1Referenced_html"><div class="ttname"><a href="classsimul_1_1base_1_1Referenced.html">simul::base::Referenced</a></div><div class="ttdef"><b>Definition:</b> <a href="Referenced_8h_source.html#l00015">Referenced.h:15</a></div></div>
<div class="ttc" id="classsimul_1_1base_1_1MemoryInterface_html"><div class="ttname"><a href="classsimul_1_1base_1_1MemoryInterface.html">simul::base::MemoryInterface</a></div><div class="ttdoc">A virtual interface class for classes that can allocate and de-allocate memory. </div><div class="ttdef"><b>Definition:</b> <a href="MemoryInterface_8h_source.html#l00045">MemoryInterface.h:45</a></div></div>
<div class="ttc" id="classsimul_1_1clouds_1_1CellularCloudNode_html_af744cfb3ad8678af9434018fb489d249"><div class="ttname"><a href="classsimul_1_1clouds_1_1CellularCloudNode.html#af744cfb3ad8678af9434018fb489d249">simul::clouds::CellularCloudNode::NeedsRelight</a></div><div class="ttdeci">virtual bool NeedsRelight() const </div><div class="ttdef"><b>Definition:</b> <a href="CellularCloudNode_8h_source.html#l00099">CellularCloudNode.h:99</a></div></div>
<div class="ttc" id="classsimul_1_1clouds_1_1HumidityCallbackInterface_html_ae9e907b6e189a32348518ea2fe04ab18"><div class="ttname"><a href="classsimul_1_1clouds_1_1HumidityCallbackInterface.html#ae9e907b6e189a32348518ea2fe04ab18">simul::clouds::HumidityCallbackInterface::GetHumidityMultiplier</a></div><div class="ttdeci">virtual float GetHumidityMultiplier(float x, float y, float z) const  =0</div></div>
<div class="ttc" id="namespacesimul_html"><div class="ttname"><a href="namespacesimul.html">simul</a></div><div class="ttdef"><b>Definition:</b> <a href="Base_8h_source.html#l00001">Base.h:1</a></div></div>
<div class="ttc" id="classsimul_1_1math_1_1Vector3_html"><div class="ttname"><a href="classsimul_1_1math_1_1Vector3.html">simul::math::Vector3</a></div><div class="ttdoc">A 3-element vector class. </div><div class="ttdef"><b>Definition:</b> <a href="Vector3_8h_source.html#l00025">Vector3.h:25</a></div></div>
<div class="ttc" id="classsimul_1_1clouds_1_1HumidityCallbackInterface_html"><div class="ttname"><a href="classsimul_1_1clouds_1_1HumidityCallbackInterface.html">simul::clouds::HumidityCallbackInterface</a></div><div class="ttdef"><b>Definition:</b> <a href="CellularCloudNode_8h_source.html#l00034">CellularCloudNode.h:34</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/>
<address style="text-align: right;">trueSKY VERSION 3.8.2<small>
Mon Feb 29 2016 07:47:14</small></address>
</body>
</html>
