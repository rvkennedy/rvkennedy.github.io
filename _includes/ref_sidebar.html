<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="{{ site.baseurl }}">
          {{ site.title }}
        </a>
      </h1>
      <p class="lead">{{ site.description }}</p>
    </div>

    <nav class="sidebar-nav">

      {% comment %}
        The code below dynamically generates a sidebar nav of pages with
        `layout: page` in the front-matter. See readme for usage.
      {% endcomment %}

      {% assign url_parts = page.url | split: '/' %}
      {% assign url_parts_size = url_parts | size %}
      {% if url_parts_size != 0 %}
        {% assign rm = url_parts | last %}
        {% assign base_url = page.url | replace: rm %}
      {% else %}
        {% assign base_url = page.url %}
      {% endif %}
      {% assign page_url =  page.url | remove: ".html"  %}
      {% assign page_url = page_url | replace: "_1_1","/" %}
      <ul>
      {% assign sorted_pages = site.pages | sort: "url" %}

      page url is {{ page.url }}

       {% assign this_path = "" %}

      {% assign paths = site.array %}
      {% for node in sorted_pages %}
        {% assign path = node.url | remove: "/index.html" %}
        {% assign path = path | remove: ".html" %}
        {% assign path = path | replace: "_1_1","/" %}
        {% assign path = path | remove_first: "/" %}
        {% assign paths = paths | push: path %}
        {% if node.url == page.url %}
          found page
          {% assign this_node = node %}
          {% assign this_path = path %}
        {% endif %}
      {% endfor %}

this_path {{ this_path }}
      {% for node in sorted_pages %}
        {% assign node_path = paths[forloop.index] %}
        {% assign node_url =  node_path %}
        {% assign node_url = node_url | remove: ".html" %}
        {% assign node_url = node_url | replace: "_1_1","/" %}

        {% assign node_url_parts = node_url | split: '/' %}
        {% assign node_url_parts_size = node_url_parts | size %}
        {% assign filename = node_url_parts | last %}
        {% if node_url_parts_size > 2 or filename == "404.html" and node.layout == "nonav" %}
           {% continue %}
        {% endif %}
        {% if node_url contains "_8md" or node_url_parts_size < 2 %} 
          {% assign node_title = node.title %}

        H{{ node_url }} {{ node_url_parts_size }} {{ node_path }}

            {% if node_title == "Home" or node_title contains "Source File" or node_title contains "Class Reference" or node_title contains "Template Reference" or node_title contains "Member List" or node_title contains " Reference" or node_title contains "Class Members" or node_title contains " Members" %}
              {% continue %}
            {% endif %}
            {% assign sz = node_title | size %}
            {% if sz < 2 %}
              {% continue %}
            {% endif %}
            <li>
            <a class="sidebar-nav-item{% if page.url == node.url %} active{% endif %}" href="{{ node.url }}">{{ node_title }}</a></li>
            {% if this_path contains node_path %}
              {% assign level2 = site.array %}
              {% for node2 in site.pages %}
                {% assign node2_url =  node2.url | remove: ".html"  %}
                {% assign node2_url = node2_url | replace: "_1_1","/" %}
                {% if node2_url contains node_url and node2_url != node_url %}
                  {% assign level2 = level2 | push: node2 %}
                {% endif %}
              {% endfor %}
            {% endif %}
        {% endif %}
      {% endfor %}
      {% for num in (1...menu_level) %}
        </ul>
      {% endfor %}
      </ul>

    </nav>
    <p>&copy; {{ site.time | date: '%Y' }} Simul Software Ltd. All rights reserved.</p>
  </div>
</div>
